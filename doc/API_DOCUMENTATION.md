COS40005 CMS API Documentation

This repository exposes a comprehensive OpenAPI/Swagger specification and interactive documentation for all API endpoints.

Files/URLs
- Swagger UI (interactive): http://localhost:8000/api/docs/  (available when the backend is running and `drf-spectacular` is installed)
- ReDoc UI: http://localhost:8000/api/redoc/
- Raw OpenAPI YAML: http://localhost:8000/api/schema/ or file `openapi_schema.yml` in the repo root (generated by `manage.py spectacular`).

Authentication
- Most endpoints require JWT bearer authentication.
- Obtain token: POST /api/token/ or compatibility POST /api/token/compat/ with JSON payload {"email":"...","password":"..."}. Response contains `access` and `refresh` tokens.
- Provide header: Authorization: Bearer <access_token>

How the documentation was generated
- We use drf-spectacular to generate OpenAPI 3.0.3 schema.
- The schema file `openapi_schema.yml` in the repo root contains the full, machine-readable spec for every endpoint.
- To regenerate locally:
  1. Ensure `drf-spectacular` is installed (it has been added to `requirements.txt`).
  2. Run: `python manage.py spectacular --file /tmp/openapi_schema.yml` (or any local path)
  3. Serve Swagger UI: `path('/api/docs/', SpectacularSwaggerView.as_view(url_name='schema'))` is wired in `config/urls.py`.

Quick examples

1) Get JWT token (PowerShell/curl):

```powershell
curl -X POST http://localhost:8000/api/token/ -H "Content-Type: application/json" -d '{"email":"staff@example.com","password":"password"}'
```

2) Upload CSV (field `data`) to import schedule (staff only):

```powershell
curl -X POST "http://localhost:8000/api/core/events/import-csv/" \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -F "data=@C:\path\to\schedule.csv"
```

3) Upload an image file (media endpoint):

```powershell
curl -X POST "http://localhost:8000/api/core/media/" \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -F "file=@C:\path\to\image.jpg"
```

Comprehensive endpoint index

The file `openapi_schema.yml` contains the full schema. For a quick human-readable index, see `endpoints_index.md` in the repo root (generated from the OpenAPI file). The top-level endpoints include (path -> methods):

(See `endpoints_index.md` for the full list.)

Notes, warnings and next steps
- drf-spectacular printed a few warnings/errors during generation about untyped path parameters and APIView-based views which do not expose serializer classes. These are cosmetic for the schema and can be addressed by adding `@extend_schema` annotations or serializer_class declarations to those views.
- If you want per-endpoint expanded human documentation (examples, request/response examples, usage notes), I can annotate selected endpoints with `@extend_schema` details and regenerate the documentation.

Contact
- If you want this documentation exported to a public HTML file, or converted to static Markdown for a docs site, tell me which format you prefer and I will export/convert it.


Generated on: 2025-11-25
